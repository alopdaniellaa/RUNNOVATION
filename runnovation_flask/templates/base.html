<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>{% block title %}Runnovation{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            background: #1F1F1F;
            color: #ffffff;
        }
        :root {
            --brand-orange: #FC4C03;
            --bg-main: #1F1F1F;
            --bg-card: #272727;
            --text-secondary: #B0B0B0;
        }
    </style>
</head>

<body class="min-h-screen bg-[var(--bg-main)] text-white flex flex-col">

   <header class="border-b border-[#333] bg-[#1A1A1A]">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">

        <!-- Logo + Title -->
        <a href="{% if user %}{{ url_for('dashboard') }}{% else %}{{ url_for('landing') }}{% endif %}"
           class="flex items-center gap-2">
            <img src="{{ url_for('static', filename='img/logo.png') }}"
                 class="h-8 w-8 object-contain"
                 alt="Runnovation Logo">

            <div>
                <p class="font-semibold text-sm tracking-wide">RUNNOVATION</p>
                <p class="text-[10px] text-[var(--text-secondary)]">Route &amp; Strava Analytics</p>
            </div>
        </a>


        <!-- NAV LINKS -->
        <nav class="flex items-center gap-4 text-sm">
            {# pages where we want ONLY auth links, even if user is logged in #}
            {% set auth_pages = ['landing', 'login', 'register', 'forgot_password'] %}

            {% if request.endpoint in auth_pages %}
                <!-- Auth-only navbar -->
                <a href="{{ url_for('login') }}" class="hover:text-[var(--brand-orange)]">
                    Login
                </a>
                <a href="{{ url_for('register') }}"
                   class="px-3 py-1 rounded-full bg-[var(--brand-orange)] text-black font-semibold">
                    Create Account
                </a>

            {% elif user %}
                <!-- Full in-app navbar (user is logged in AND not on auth pages) -->
                <a href="{{ url_for('dashboard') }}" class="hover:text-[var(--brand-orange)]">Dashboard</a>
                <a href="{{ url_for('strava_analytics') }}" class="hover:text-[var(--brand-orange)]">Strava Analytics</a>
                <a href="{{ url_for('route_analytics') }}" class="hover:text-[var(--brand-orange)]">Routes</a>
                <a href="{{ url_for('community_insights') }}" class="hover:text-[var(--brand-orange)]">Community</a>
                <a href="{{ url_for('profile') }}" class="hover:text-[var(--brand-orange)]">Profile</a>
                <a href="{{ url_for('about') }}" class="hover:text-[var(--brand-orange)]">About</a>
                <a href="{{ url_for('logout') }}" class="ml-3 text-red-400 hover:text-red-300">Logout</a>

            {% else %}
                <!-- Fallback for any other page when not logged in -->
                <a href="{{ url_for('login') }}" class="hover:text-[var(--brand-orange)]">
                    Login
                </a>
                <a href="{{ url_for('register') }}"
                   class="px-3 py-1 rounded-full bg-[var(--brand-orange)] text-black font-semibold">
                    Create Account
                </a>
            {% endif %}
        </nav>

    </div>
</header>


    <!-- Flash Messages -->
    <div class="max-w-6xl mx-auto w-full px-4 mt-3">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="mb-2 px-3 py-2 text-xs rounded-md
                    {% if category == 'error' %} bg-red-900/40 border border-red-700
                    {% elif category == 'success' %} bg-emerald-900/40 border border-emerald-700
                    {% else %} bg-[#222] border border-[#333] {% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
        {% endwith %}
    </div>

    <!-- Page Content -->
    <main class="flex-1 max-w-6xl mx-auto w-full px-4 py-6">
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="border-t border-[#333] text-[11px] text-[var(--text-secondary)] py-3 text-center">
        RUNNOVATION · Strava-Driven Analytics · 2025
    </footer>

</body>
</html>
